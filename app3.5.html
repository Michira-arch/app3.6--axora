<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AXORA-TACHYS</title>
    
    <!-- Tailwind CSS for rapid UI development -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Roboto -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Phosphor Icons for a modern look -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        /* Custom Styles */
        body {
            font-family: 'Roboto', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --accent-color: #0d9488;
            --accent-color-dark: #0f766e;
            --accent-color-light: #f0fdfa;
        }

        .app-container {
            max-width: 420px;
            height: 100vh;
            height: 100dvh;
            margin: 0 auto;
            border-left: 1px solid #e5e7eb;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            background-color: #f9fafb;
        }

        @media (min-width: 421px) {
            .app-container {
                height: 800px;
                border-radius: 24px;
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
                margin-top: 2rem;
                margin-bottom: 2rem;
            }
        }

        /* Mobile scaling class */
        .mobile-scaled {
            transform-origin: top;
        }

        .page {
            display: none;
            flex-grow: 1;
            overflow-y: auto;
            flex-direction: column;
        }

        .page.active {
            display: flex;
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
            font-weight: 500;
            padding: 0.75rem;
            border-radius: 0.5rem;
            text-align: center;
            transition: background-color 0.2s;
        }

        .btn-primary:hover, .btn-primary:focus {
            background-color: var(--accent-color-dark);
        }

        .btn-secondary {
            background-color: #e5e7eb;
            color: #1f2937;
            font-weight: 500;
            padding: 0.75rem;
            border-radius: 0.5rem;
            text-align: center;
            transition: background-color 0.2s;
        }

        .btn-secondary:hover {
            background-color: #d1d5db;
        }

        .dark .btn-secondary {
            background-color: #4b5563;
            color: #f3f4f6;
        }

        .dark .btn-secondary:hover {
            background-color: #6b7280;
        }

        .input-field {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            background-color: #f9fafb;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px var(--accent-color-light);
        }

        .dark .input-field {
            background-color: #374151;
            border-color: #4b5563;
            color: #f3f4f6;
        }

        .bottom-nav {
            display: flex;
            justify-content: space-around;
            padding: 0.5rem 0;
            border-top: 1px solid #e5e7eb;
            background-color: white;
            flex-shrink: 0;
        }

        .dark .bottom-nav {
            background-color: #1f2937;
            border-top-color: #4b5563;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #6b7280;
            font-size: 0.75rem;
            cursor: pointer;
        }

        .dark .nav-item {
            color: #9ca3af;
        }

        .nav-item.active {
            color: var(--accent-color);
        }

        .nav-item i {
            font-size: 1.75rem;
        }

        .dark .nav-item i {
            color: #9ca3af;
        }

        .nav-item.active i {
            color: var(--accent-color);
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900">
    <div class="app-container bg-white dark:bg-gray-900">
        <main class="flex-grow overflow-y-auto">
            <div id="onboarding-page" class="page active p-6 justify-between bg-white dark:bg-gray-900">
                <div id="onboarding-content"></div>
                <div class="space-y-4">
                    <div id="onboarding-dots" class="flex justify-center space-x-2"></div>
                    <button id="onboarding-next-btn" class="btn-primary w-full">Next</button>
                    <button id="onboarding-skip-btn" class="w-full text-center text-gray-500 dark:text-gray-400 font-medium py-2">Skip</button>
                </div>
            </div>

            <div id="login-signup-page" class="page justify-center items-center bg-white dark:bg-gray-900">
                <div class="w-full p-8 space-y-6">
                    <div class="text-center">
                        <i class="ph-bold ph-bus text-5xl" style="color: var(--accent-color);"></i>
                        <h1 class="text-3xl font-bold text-gray-800 dark:text-gray-200">AXORA-TACHYS</h1>
                    </div>
                    
                    <div class="bg-gray-200 dark:bg-gray-700 rounded-lg p-1 flex">
                        <button id="login-tab-btn" class="w-1/2 p-2 rounded-md text-center font-medium bg-white dark:bg-gray-800 shadow">Login</button>
                        <button id="signup-tab-btn" class="w-1/2 p-2 rounded-md text-center font-medium text-gray-600 dark:text-gray-400">Sign Up</button>
                    </div>

                    <div id="login-form" class="space-y-4">
                        <input type="email" placeholder="Email" class="input-field">
                        <input type="password" placeholder="Password" class="input-field">
                        <a href="#" class="block text-sm text-right font-medium" style="color: var(--accent-color);">Forgot Password?</a>
                        <button class="btn-primary w-full" onclick="showPage('home-page', 'home')">Login</button>
                    </div>

                    <div id="signup-form" class="hidden space-y-4">
                        <input type="text" placeholder="Full Name" class="input-field">
                        <input type="email" placeholder="Email" class="input-field">
                        <input type="password" placeholder="Password" class="input-field">
                        <input type="tel" placeholder="Phone Number" class="input-field">
                        <button class="btn-primary w-full" onclick="showPage('home-page', 'home')">Sign Up</button>
                    </div>
                    
                    <div class="relative flex py-2 items-center">
                        <div class="flex-grow border-t border-gray-300 dark:border-gray-600"></div>
                        <span class="flex-shrink mx-4 text-gray-500 dark:text-gray-400 text-sm">Or continue with</span>
                        <div class="flex-grow border-t border-gray-300 dark:border-gray-600"></div>
                    </div>
                    
                    <div class="flex space-x-4">
                        <button class="btn-secondary w-full flex items-center justify-center space-x-2" onclick="showPage('home-page', 'home')">
                            <i class="ph-fill ph-google-logo text-xl"></i>
                            <span>Google</span>
                        </button>
                        <button class="btn-secondary w-full flex items-center justify-center space-x-2" onclick="showPage('home-page', 'home')">
                            <i class="ph-fill ph-facebook-logo text-xl"></i>
                            <span>Facebook</span>
                        </button>
                    </div>
                </div>
            </div>

            <div id="home-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-gray-500 dark:text-gray-400">Welcome back,</p>
                        <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200">Alex Kamau</h2>
                    </div>
                    <div class="w-12 h-12 bg-gray-300 dark:bg-gray-600 rounded-full overflow-hidden">
                        <img src="https://placehold.co/100x100/E2E8F0/4A5568?text=A" alt="Profile Picture" class="w-full h-full object-cover">
                    </div>
                </div>

                <div class="relative rounded-lg overflow-hidden h-40 flex items-end p-4 text-white bg-cover bg-center" style="background-image: url('https://placehold.co/600x400/0d9488/ffffff?text=Premium+Bus');">
                    <div class="absolute inset-0 bg-black opacity-40"></div>
                    <h3 class="text-3xl font-bold z-10 relative">Travel with Dignity</h3>
                </div>

                <div class="grid grid-cols-3 gap-4 text-center">
                    <div onclick="showPage('search-page', 'book')" class="p-4 bg-teal-50 dark:bg-teal-900 rounded-lg cursor-pointer hover:bg-teal-100 dark:hover:bg-teal-800 transition">
                        <i class="ph-bold ph-bus text-4xl mx-auto" style="color: var(--accent-color);"></i>
                        <p class="font-medium text-sm mt-2 text-gray-700 dark:text-gray-300">Book a Trip</p>
                    </div>
                    <div onclick="showPage('tracking-page', 'track')" class="p-4 bg-teal-50 dark:bg-teal-900 rounded-lg cursor-pointer hover:bg-teal-100 dark:hover:bg-teal-800 transition">
                        <i class="ph-bold ph-map-pin text-4xl mx-auto" style="color: var(--accent-color);"></i>
                        <p class="font-medium text-sm mt-2 text-gray-700 dark:text-gray-300">Track Bus</p>
                    </div>
                    <div onclick="showPage('subscription-page', 'profile')" class="p-4 bg-teal-50 dark:bg-teal-900 rounded-lg cursor-pointer hover:bg-teal-100 dark:hover:bg-teal-800 transition">
                        <i class="ph-bold ph-calendar text-4xl mx-auto" style="color: var(--accent-color);"></i>
                        <p class="font-medium text-sm mt-2 text-gray-700 dark:text-gray-300">Subscriptions</p>
                    </div>
                </div>

                <div class="mt-6">
                    <button onclick="showPage('quick-pay-page', 'book')" class="btn-primary w-full flex items-center justify-center space-x-2">
                        <i class="ph ph-credit-card"></i>
                        <span>Quick Pay</span>
                    </button>
                </div>

                <div>
                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 mb-4">Today's Trips</h3>
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 space-y-3">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="font-bold text-gray-800 dark:text-gray-200">Nairobi CBD <i class="ph ph-arrow-right"></i> Westlands</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Departure: 8:00 AM</p>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-sm" style="color: var(--accent-color);">KBE 123X</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Seat 7A</p>
                            </div>
                        </div>
                        <div class="text-center text-gray-500 dark:text-gray-400 pt-2">
                            No other trips today.
                        </div>
                    </div>
                </div>
            </div>

            <div id="search-page" class="page p-6 space-y-4 bg-white dark:bg-gray-900">
                <div class="flex items-center mb-2">
                    <button onclick="showPage('home-page', 'home')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">Find Your Route</h2>
                </div>
                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 space-y-4">
                    <input type="text" placeholder="From" value="Nairobi CBD" class="input-field">
                    <input type="text" placeholder="To" value="Westlands" class="input-field">
                    <div class="flex space-x-4">
                        <input type="date" value="2025-07-27" class="input-field">
                        <input type="time" value="08:00" class="input-field">
                    </div>
                    <button class="btn-primary w-full">Search</button>
                </div>
                
                <div id="search-results" class="space-y-3">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200 pt-2">Available Buses</h3>
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:border-teal-500" onclick="showPage('booking-page', 'book')">
                        <div class="flex justify-between items-center">
                            <div>
                                <span class="text-xs font-bold uppercase px-2 py-1 rounded-full bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300">Luxury</span>
                                <p class="font-bold text-lg text-gray-800 dark:text-gray-200 mt-1">8:00 AM – 8:25 AM</p>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold" style="color: var(--accent-color);">120 KES</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">15 seats left</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:border-teal-500" onclick="showPage('booking-page', 'book')">
                        <div class="flex justify-between items-center">
                            <div>
                                <span class="text-xs font-bold uppercase px-2 py-1 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300">Standard</span>
                                <p class="font-bold text-lg text-gray-800 dark:text-gray-200 mt-1">8:15 AM – 8:45 AM</p>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold" style="color: var(--accent-color);">80 KES</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">22 seats left</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="booking-page" class="page space-y-4 bg-white dark:bg-gray-900">
                <div class="p-6 pb-0">
                    <div class="flex items-center mb-4">
                        <button onclick="showPage('search-page', 'book')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                        <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200 ml-2">Nairobi CBD to Westlands, 8:00 AM</h2>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                        <p class="text-center text-gray-500 dark:text-gray-400 mb-4 font-medium">Select Your Seat</p>
                        <div id="seat-map" class="grid grid-cols-5 gap-2 max-w-xs mx-auto"></div>
                        <div class="flex justify-center space-x-4 mt-4 text-sm">
                            <div class="flex items-center"><span class="w-4 h-4 bg-gray-200 dark:bg-gray-600 rounded-sm mr-2"></span>Available</div>
                            <div class="flex items-center"><span class="w-4 h-4 bg-red-500 rounded-sm mr-2"></span>Booked</div>
                            <div class="flex items-center"><span class="w-4 h-4 rounded-sm mr-2" style="background-color: var(--accent-color);"></span>Selected</div>
                        </div>
                    </div>

                    <div class="mt-6">
                        <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200">Add-ons</h3>
                        <div class="mt-2 space-y-2">
                            <label class="flex items-center justify-between bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                                <div>
                                    <p class="font-medium text-gray-800 dark:text-gray-200">Extra Legroom</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">+20 KES</p>
                                </div>
                                <input type="checkbox" class="h-5 w-5 rounded text-teal-600 focus:ring-teal-500">
                            </label>
                            <label class="flex items-center justify-between bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                                <div>
                                    <p class="font-medium text-gray-800 dark:text-gray-200">Snack Pack</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">+50 KES</p>
                                </div>
                                <input type="checkbox" class="h-5 w-5 rounded text-teal-600 focus:ring-teal-500">
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="p-6 mt-auto bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-gray-600 dark:text-gray-400">Total</span>
                        <span class="text-2xl font-bold text-gray-800 dark:text-gray-200">140 KES</span>
                    </div>
                    <button class="btn-primary w-full" onclick="showPage('payment-page', 'book')">Confirm Booking</button>
                </div>
            </div>
            
            <div id="payment-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex items-center">
                    <button onclick="showPage('booking-page', 'book')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">Payment</h2>
                </div>

                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Order Summary</h3>
                    <div class="text-gray-600 dark:text-gray-400 space-y-1 text-sm">
                        <div class="flex justify-between"><p>Route:</p> <p class="font-medium">Nairobi CBD - Westlands</p></div>
                        <div class="flex justify-between"><p>Seat:</p> <p class="font-medium">7A</p></div>
                        <div class="flex justify-between"><p>Add-ons:</p> <p class="font-medium">Extra Legroom</p></div>
                        <div class="border-t my-2 border-gray-200 dark:border-gray-700"></div>
                        <div class="flex justify-between font-bold text-base"><p>Total:</p> <p>140 KES</p></div>
                    </div>
                </div>

                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Payment Method</h3>
                    <div class="space-y-3">
                        <div class="p-4 rounded-lg border-2 border-teal-500 bg-teal-50 dark:bg-teal-900 flex items-center space-x-4">
                            <i class="ph-fill ph-wallet text-4xl" style="color: var(--accent-color);"></i>
                            <div class="flex-grow">
                                <p class="font-bold text-gray-800 dark:text-gray-200">Wallet</p>
                                <p id="payment-wallet-balance" class="text-sm text-teal-700 dark:text-teal-400">Balance: KES 1,250.00</p>
                            </div>
                            <div class="w-5 h-5 rounded-full border-2 border-teal-500 bg-white dark:bg-gray-800 flex items-center justify-center">
                                <div class="w-3 h-3 rounded-full bg-teal-500"></div>
                            </div>
                        </div>
                        <div class="p-4 rounded-lg border border-gray-200 dark:border-gray-700 flex items-center space-x-4">
                            <img src="https://placehold.co/40x40/10B981/FFFFFF?text=MP" alt="M-Pesa" class="w-10 h-10 rounded-full">
                            <p class="font-bold text-gray-800 dark:text-gray-200 flex-grow">M-Pesa</p>
                        </div>
                        <div class="p-4 rounded-lg border border-gray-200 dark:border-gray-700 flex items-center space-x-4">
                            <i class="ph-fill ph-credit-card text-4xl text-gray-400 dark:text-gray-500"></i>
                            <p class="font-bold text-gray-800 dark:text-gray-200 flex-grow">Visa / MasterCard</p>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Redeem Coins</h3>
                    <div class="flex items-center space-x-2">
                        <input type="text" placeholder="e.g. 400 coins" class="input-field flex-grow">
                        <button class="btn-secondary px-4">Apply</button>
                    </div>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">You have <span id="payment-coin-balance" class="font-medium text-teal-600">420</span> coins available (KES <span id="payment-coin-value">105.00</span>)</p>
                </div>

                <button class="btn-primary w-full !mt-8" onclick="showPage('confirmation-page', 'book')">Pay Now</button>
            </div>

            <div id="confirmation-page" class="page p-6 justify-center items-center text-center space-y-6 bg-white dark:bg-gray-900">
                <div class="w-full">
                    <i class="ph-bold ph-check-circle text-7xl text-green-500"></i>
                    <h2 class="text-3xl font-bold text-gray-800 dark:text-gray-200 mt-4">Booking Confirmed!</h2>
                    <p class="text-gray-500 dark:text-gray-400">Your digital ticket is ready.</p>
                </div>
                
                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 w-full max-w-sm text-left space-y-4">
                    <div class="flex justify-center">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=AXORA-TACHYS-TICKET-ID-12345&bgcolor=f9fafb" alt="QR Code" class="rounded-md">
                    </div>
                    <div class="border-t pt-4 border-gray-200 dark:border-gray-700">
                        <p class="text-sm text-gray-500 dark:text-gray-400">Route</p>
                        <p class="font-bold text-gray-800 dark:text-gray-200">Nairobi CBD to Westlands</p>
                    </div>
                    <div class="flex justify-between">
                        <div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Date & Time</p>
                            <p class="font-bold text-gray-800 dark:text-gray-200">Jul 27, 8:00 AM</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Seat</p>
                            <p class="font-bold text-gray-800 dark:text-gray-200">7A</p>
                        </div>
                    </div>
                </div>

                <div class="w-full max-w-sm space-y-3">
                    <button class="btn-primary w-full flex items-center justify-center space-x-2">
                        <i class="ph ph-calendar-plus"></i>
                        <span>Add to Calendar</span>
                    </button>
                    <button class="btn-secondary w-full" onclick="showPage('home-page', 'home')">Done</button>
                </div>
            </div>

            <div id="tracking-page" class="page bg-white dark:bg-gray-900">
                <div class="flex-grow relative">
                    <div class="absolute inset-0 bg-gray-300 dark:bg-gray-700 flex items-center justify-center">
                        <img src="https://placehold.co/420x500/E5E7EB/4A5568?text=Map+View" alt="Map Placeholder" class="w-full h-full object-cover">
                    </div>
                    <div class="absolute top-4 left-4 right-4 bg-white dark:bg-gray-800 p-3 rounded-lg shadow-lg flex items-center">
                        <button onclick="showPage('home-page', 'home')" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-xl"></i></button>
                        <div class="flex items-center flex-grow ml-2">
                            <i class="ph-bold ph-bus text-2xl mr-3" style="color: var(--accent-color);"></i>
                            <div>
                                <p class="font-bold text-gray-800 dark:text-gray-200">ETA: 8 minutes</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Arriving at Kencom House</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-6 bg-white dark:bg-gray-800 rounded-t-2xl shadow-lg space-y-4 flex-shrink-0">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-gray-200">Bus Details</h3>
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Driver</p>
                            <p class="font-medium text-gray-800 dark:text-gray-200">James Mwangi</p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Plate Number</p>
                            <p class="font-medium text-gray-800 dark:text-gray-200">KBE 123X</p>
                        </div>
                        <button class="p-3 rounded-full" style="background-color: var(--accent-color-light); color: var(--accent-color);">
                            <i class="ph-fill ph-phone text-2xl"></i>
                        </button>
                    </div>
                    <label class="flex items-center justify-between bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
                        <span class="font-medium text-gray-700 dark:text-gray-300">Notify me with updates</span>
                        <div class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" value="" class="sr-only peer" checked>
                            <div class="w-11 h-6 bg-gray-200 dark:bg-gray-600 rounded-full peer peer-focus:ring-4 peer-focus:ring-teal-300 dark:peer-focus:ring-teal-800 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-teal-600"></div>
                        </div>
                    </label>
                </div>
            </div>

            <div id="subscription-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex items-center mb-4">
                    <button onclick="showPage('profile-page', 'profile')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">My Subscriptions</h2>
                </div>
                
                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Current Plan</h3>
                    <div class="bg-teal-50 dark:bg-teal-900 border-2 border-teal-500 p-4 rounded-lg">
                        <p class="font-bold text-lg text-teal-800 dark:text-teal-300">Monthly Pass</p>
                        <p class="text-teal-700 dark:text-teal-400">4,000 KES / month</p>
                        <div class="w-full bg-teal-200 dark:bg-teal-800 rounded-full h-2.5 mt-3">
                            <div class="bg-teal-600 h-2.5 rounded-full" style="width: 45%"></div>
                        </div>
                        <p class="text-sm text-teal-700 dark:text-teal-400 mt-1">18 of 40 trips used. Renews on Aug 1, 2025.</p>
                        <button class="text-sm font-medium text-red-600 dark:text-red-400 mt-3">Cancel Subscription</button>
                    </div>
                </div>

                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Available Plans</h3>
                    <div class="space-y-3">
                        <div class="p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                            <p class="font-bold text-gray-800 dark:text-gray-200">Weekly Pass</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">10 trips</p>
                            <div class="flex justify-between items-center mt-2">
                                <p class="text-lg font-bold" style="color: var(--accent-color);">1,000 KES</p>
                                <button class="btn-secondary px-4 py-2 text-sm">Subscribe</button>
                            </div>
                        </div>
                        <div class="p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                            <p class="font-bold text-gray-800 dark:text-gray-200">Annual Pass</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">480 trips</p>
                            <div class="flex justify-between items-center mt-2">
                                <p class="text-lg font-bold" style="color: var(--accent-color);">45,000 KES</p>
                                <button class="btn-secondary px-4 py-2 text-sm">Subscribe</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="profile-page" class="page p-6 space-y-8 bg-white dark:bg-gray-900">
                <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200">Profile</h2>
                <div class="flex items-center space-x-4">
                    <div class="w-20 h-20 bg-gray-300 dark:bg-gray-600 rounded-full overflow-hidden">
                        <img src="https://placehold.co/100x100/E2E8F0/4A5568?text=A" alt="Profile Picture" class="w-full h-full object-cover">
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200">Alex Kamau</h3>
                        <p class="text-gray-500 dark:text-gray-400">alex.kamau@example.com</p>
                    </div>
                </div>
                <div class="space-y-2">
                    <a href="#" onclick="showPage('wallet-page', 'profile')" class="flex items-center justify-between p-4 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition">
                        <div class="flex items-center space-x-4">
                            <i class="ph ph-wallet text-2xl" style="color: var(--accent-color);"></i>
                            <span class="font-medium text-gray-700 dark:text-gray-300">My Wallet</span>
                        </div>
                        <i class="ph ph-caret-right text-xl text-gray-500 dark:text-gray-400"></i>
                    </a>
                    <a href="#" onclick="showPage('loyalty-page', 'profile')" class="flex items-center justify-between p-4 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition">
                        <div class="flex items-center space-x-4">
                            <i class="ph ph-coin text-2xl" style="color: var(--accent-color);"></i>
                            <span class="font-medium text-gray-700 dark:text-gray-300">Loyalty Coins</span>
                        </div>
                        <i class="ph ph-caret-right text-xl text-gray-500 dark:text-gray-400"></i>
                    </a>
                    <a href="#" onclick="showPage('subscription-page', 'profile')" class="flex items-center justify-between p-4 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition">
                        <div class="flex items-center space-x-4">
                            <i class="ph ph-star text-2xl" style="color: var(--accent-color);"></i>
                            <span class="font-medium text-gray-700 dark:text-gray-300">My Subscriptions</span>
                        </div>
                        <i class="ph ph-caret-right text-xl text-gray-500 dark:text-gray-400"></i>
                    </a>
                    <a href="#" onclick="showPage('trip-history-page', 'profile')" class="flex items-center justify-between p-4 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition">
                        <div class="flex items-center space-x-4">
                            <i class="ph ph-clock-counter-clockwise text-2xl" style="color: var(--accent-color);"></i>
                            <span class="font-medium text-gray-700 dark:text-gray-300">Trip History</span>
                        </div>
                        <i class="ph ph-caret-right text-xl text-gray-500 dark:text-gray-400"></i>
                    </a>
                    <a href="#" onclick="showPage('support-page', 'profile')" class="flex items-center justify-between p-4 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition">
                        <div class="flex items-center space-x-4">
                            <i class="ph ph-question text-2xl" style="color: var(--accent-color);"></i>
                            <span class="font-medium text-gray-700 dark:text-gray-300">Customer Support</span>
                        </div>
                        <i class="ph ph-caret-right text-xl text-gray-500 dark:text-gray-400"></i>
                    </a>
                    <a href="#" onclick="showPage('settings-page', 'profile')" class="flex items-center justify-between p-4 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition">
                        <div class="flex items-center space-x-4">
                            <i class="ph ph-gear text-2xl" style="color: var(--accent-color);"></i>
                            <span class="font-medium text-gray-700 dark:text-gray-300">Settings</span>
                        </div>
                        <i class="ph ph-caret-right text-xl text-gray-500 dark:text-gray-400"></i>
                    </a>
                </div>
                <button onclick="showPage('login-signup-page', null)" class="w-full text-center text-red-500 dark:text-red-400 font-medium py-3 bg-red-50 dark:bg-red-900/20 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 transition">Logout</button>
            </div>
            
            <div id="trip-history-page" class="page p-6 space-y-4 bg-white dark:bg-gray-900">
                <div class="flex items-center mb-4">
                    <button onclick="showPage('profile-page', 'profile')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">Trip History</h2>
                </div>
                <div class="space-y-3">
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-bold text-gray-800 dark:text-gray-200">Nairobi CBD - Westlands</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">July 24, 2025</p>
                            </div>
                            <p class="font-bold text-gray-700 dark:text-gray-300">120 KES</p>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="btn-secondary text-sm py-1 px-3 flex-1">View Receipt</button>
                            <button class="btn-primary text-sm py-1 px-3 flex-1" onclick="showPage('feedback-page', 'profile')">Rate Trip</button>
                        </div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-bold text-gray-800 dark:text-gray-200">Westlands - Nairobi CBD</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">July 23, 2025</p>
                            </div>
                            <p class="font-bold text-gray-700 dark:text-gray-300">120 KES</p>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button class="btn-secondary text-sm py-1 px-3 flex-1">View Receipt</button>
                            <button class="btn-secondary text-sm py-1 px-3 flex-1 disabled:opacity-50" disabled>Rated</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="support-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex items-center mb-4">
                    <button onclick="showPage('profile-page', 'profile')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">Customer Support</h2>
                </div>
                
                <button class="btn-primary w-full flex items-center justify-center space-x-2">
                    <i class="ph ph-chats-circle"></i>
                    <span>Chat with Us</span>
                </button>

                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">FAQs</h3>
                    <div class="space-y-2">
                        <details class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg">
                            <summary class="font-medium cursor-pointer text-gray-700 dark:text-gray-300">How do I cancel a booking?</summary>
                            <p class="text-gray-600 dark:text-gray-400 mt-2 text-sm">You can cancel a booking up to 1 hour before departure from the 'Trip Details' page.</p>
                        </details>
                        <details class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg">
                            <summary class="font-medium cursor-pointer text-gray-700 dark:text-gray-300">Are subscriptions auto-renewed?</summary>
                            <p class="text-gray-600 dark:text-gray-400 mt-2 text-sm">Yes, all subscriptions are auto-renewed. You can cancel anytime from the 'My Subscriptions' page.</p>
                        </details>
                    </div>
                </div>

                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Submit a Ticket</h3>
                    <div class="space-y-3">
                        <input type="text" placeholder="Subject" class="input-field">
                        <textarea placeholder="Describe your issue..." rows="4" class="input-field"></textarea>
                        <button class="btn-secondary w-full">Submit Ticket</button>
                    </div>
                </div>
            </div>
            
            <div id="feedback-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex items-center mb-4">
                    <button onclick="showPage('trip-history-page', 'profile')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">Rate Your Trip</h2>
                </div>
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700 text-center">
                    <p class="font-medium text-gray-800 dark:text-gray-200 mb-4">How was your trip from Nairobi CBD to Westlands?</p>
                    <div class="flex justify-center text-4xl text-gray-300 dark:text-gray-500 space-x-2">
                        <i class="ph ph-star cursor-pointer hover:text-yellow-400"></i>
                        <i class="ph ph-star cursor-pointer hover:text-yellow-400"></i>
                        <i class="ph ph-star cursor-pointer hover:text-yellow-400"></i>
                        <i class="ph ph-star cursor-pointer hover:text-yellow-400"></i>
                        <i class="ph ph-star cursor-pointer hover:text-yellow-400"></i>
                    </div>
                </div>
                <textarea placeholder="Add a comment..." rows="4" class="input-field"></textarea>
                <button class="btn-primary w-full" onclick="showPage('trip-history-page', 'profile')">Submit Feedback</button>
            </div>
            
            <div id="settings-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex items-center mb-4">
                    <button onclick="showPage('profile-page', 'profile')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">Settings</h2>
                </div>
                
                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Notifications</h3>
                    <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 divide-y">
                        <label class="flex items-center justify-between p-4">
                            <span class="font-medium text-gray-700 dark:text-gray-300">Trip Reminders</span>
                            <input type="checkbox" class="h-5 w-5 rounded text-teal-600 focus:ring-teal-500" checked>
                        </label>
                        <label class="flex items-center justify-between p-4">
                            <span class="font-medium text-gray-700 dark:text-gray-300">Promotions</span>
                            <input type="checkbox" class="h-5 w-5 rounded text-teal-600 focus:ring-teal-500">
                        </label>
                    </div>
                </div>
                
                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Theme</h3>
                    <label class="flex items-center justify-between p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700">
                        <span class="font-medium text-gray-700 dark:text-gray-300">Dark Mode</span>
                        <input type="checkbox" id="dark-mode-toggle" class="h-5 w-5 rounded text-teal-600 focus:ring-teal-500">
                    </label>
                </div>

                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Language</h3>
                    <select class="input-field">
                        <option>English</option>
                        <option>Swahili</option>
                    </select>
                </div>

                <div class="space-y-2">
                    <a href="#" class="block text-center font-medium py-3 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition">Change Password</a>
                    <a href="#" class="block text-center font-medium py-3 text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 transition">Delete Account</a>
                </div>
            </div>

            <div id="quick-pay-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex items-center">
                    <button onclick="showPage('home-page', 'home')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">Quick Pay</h2>
                </div>
                <p class="text-gray-600 dark:text-gray-400">Please enter the 3-digit code printed on the bus window.</p>
                <div class="flex space-x-2">
                    <input type="text" id="bus-code-input" maxlength="3" class="input-field flex-grow text-center" placeholder="e.g. 003">
                    <button id="find-bus-btn" class="btn-primary px-4">Find Bus</button>
                </div>
                <div id="bus-info" class="hidden space-y-4">
                    <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                        <p class="font-bold text-gray-800 dark:text-gray-200">Route: Nairobi CBD - Westlands</p>
                        <p class="text-gray-600 dark:text-gray-400">Departure: 8:00 AM</p>
                        <p class="text-gray-600 dark:text-gray-400">Price: 120 KES</p>
                    </div>
                    <button id="pay-btn" class="btn-primary w-full" onclick="showPage('confirmation-page', 'book')">Pay KES 120</button>
                </div>
                <div id="error-message" class="hidden text-red-500 dark:text-red-400 text-center">Invalid bus code. Please try again.</div>
            </div>

            <div id="wallet-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex items-center">
                    <button onclick="showPage('profile-page', 'profile')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">My Wallet</h2>
                </div>
                <div class="bg-teal-600 text-white p-6 rounded-xl text-center space-y-2">
                    <p class="opacity-80">Current Balance</p>
                    <p id="wallet-balance-display" class="text-4xl font-bold">KES 1,250.00</p>
                </div>
                <button class="btn-primary w-full" onclick="showPage('top-up-page', 'profile')">Add Money</button>
                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Recent Transactions</h3>
                    <div id="wallet-transactions" class="space-y-3"></div>
                </div>
            </div>

            <div id="top-up-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex items-center">
                    <button onclick="showPage('wallet-page', 'profile')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">Top Up Wallet</h2>
                </div>
                <div class="space-y-4">
                    <input type="number" placeholder="Enter Amount (KES)" class="input-field text-center text-2xl h-auto">
                    <div class="grid grid-cols-3 gap-2">
                        <button class="btn-secondary py-3">+500</button>
                        <button class="btn-secondary py-3">+1000</button>
                        <button class="btn-secondary py-3">+2000</button>
                    </div>
                </div>
                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Select Method</h3>
                    <div class="space-y-3">
                        <div class="p-4 rounded-lg border-2 border-teal-500 bg-teal-50 dark:bg-teal-900 flex items-center space-x-4">
                            <img src="https://placehold.co/40x40/10B981/FFFFFF?text=MP" alt="M-Pesa" class="w-10 h-10 rounded-full">
                            <p class="font-bold text-gray-800 dark:text-gray-200 flex-grow">M-Pesa</p>
                            <div class="w-5 h-5 rounded-full border-2 border-teal-500 bg-white dark:bg-gray-800 flex items-center justify-center">
                                <div class="w-3 h-3 rounded-full bg-teal-500"></div>
                            </div>
                        </div>
                        <div class="p-4 rounded-lg border border-gray-200 dark:border-gray-700 flex items-center space-x-4">
                            <i class="ph-fill ph-credit-card text-4xl text-gray-400 dark:text-gray-500"></i>
                            <p class="font-bold text-gray-800 dark:text-gray-200 flex-grow">Bank Card</p>
                        </div>
                    </div>
                </div>
                <button class="btn-primary w-full !mt-8">Proceed to Top Up</button>
            </div>

            <div id="loyalty-page" class="page p-6 space-y-6 bg-white dark:bg-gray-900">
                <div class="flex items-center">
                    <button onclick="showPage('profile-page', 'profile')" class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"><i class="ph ph-arrow-left text-2xl"></i></button>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200 ml-2">Loyalty Coins</h2>
                </div>
                <div class="bg-yellow-400 text-yellow-900 p-6 rounded-xl text-center space-y-2">
                    <p class="opacity-80">Your Coins</p>
                    <p id="loyalty-coin-balance" class="text-4xl font-bold">420</p>
                    <p id="loyalty-coin-value" class="font-medium">Equal to KES 105.00</p>
                </div>
                <button class="btn-primary w-full" onclick="showPage('payment-page', 'book')">Redeem Coins on a Ride</button>
                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">How it Works</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
                        <li>Earn <span class="font-bold">10 coins</span> for every KES 100 spent using Wallet.</li>
                        <li>Earn <span class="font-bold">5 coins</span> for every KES 100 spent using other payment methods.</li>
                        <li>Redeem your coins for discounts. <span class="font-bold">400 coins = KES 100</span> (1 coin = KES 0.25).</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-2">Coin History</h3>
                    <div id="loyalty-history" class="space-y-3"></div>
                </div>
            </div>
        </main>

        <nav id="bottom-nav-bar" class="bottom-nav hidden">
            <div class="nav-item active" id="nav-home" onclick="showPage('home-page', 'home')">
                <i class="ph-fill ph-house"></i>
                <span>Home</span>
            </div>
            <div class="nav-item" id="nav-book" onclick="showPage('search-page', 'book')">
                <i class="ph ph-bus"></i>
                <span>Book</span>
            </div>
            <div class="nav-item" id="nav-track" onclick="showPage('tracking-page', 'track')">
                <i class="ph ph-map-trifold"></i>
                <span>Track</span>
            </div>
            <div class="nav-item" id="nav-profile" onclick="showPage('profile-page', 'profile')">
                <i class="ph ph-user-circle"></i>
                <span>Profile</span>
            </div>
        </nav>
    </div>

    <script>
        // --- App State (Simulated) ---
        const appState = {
            walletBalance: 1250.00,
            loyaltyCoins: 420,
            isWalletUser: true, // Simulating a wallet user for demo
            walletTransactions: [
                { type: 'Top-up', method: 'M-Pesa', amount: 1000, date: '2025-07-24' },
                { type: 'Payment', description: 'Trip to Westlands', amount: -120, date: '2025-07-24', paymentMethod: 'Wallet' },
                { type: 'Top-up', method: 'Card', amount: 500, date: '2025-07-22' },
            ],
            coinHistory: [
                { type: 'Earned', description: 'Trip to Westlands (Wallet)', amount: 12, date: '2025-07-24' },
                { type: 'Earned', description: 'Trip to Nairobi CBD (M-Pesa)', amount: 6, date: '2025-07-23' },
                { type: 'Redeemed', description: 'Discount on Trip', amount: -400, date: '2025-07-21' },
            ]
        };

        // --- PAGE NAVIGATION ---
        const pages = document.querySelectorAll('.page');
        const bottomNav = document.getElementById('bottom-nav-bar');
        const navItems = document.querySelectorAll('.nav-item');
        let currentPageId = 'onboarding-page';

        function showPage(pageId, navId = null) {
            const currentPage = document.getElementById(currentPageId);
            if (currentPage) {
                currentPage.classList.remove('active');
            }

            const newPage = document.getElementById(pageId);
            if (newPage) {
                newPage.scrollTop = 0;
                newPage.classList.add('active');
                currentPageId = pageId;
            }
            
            const pagesWithoutNav = ['onboarding-page', 'login-signup-page'];
            if (pagesWithoutNav.includes(pageId)) {
                bottomNav.classList.add('hidden');
                bottomNav.classList.remove('flex');
            } else {
                bottomNav.classList.remove('hidden');
                bottomNav.classList.add('flex');
            }

            if (navId) {
                navItems.forEach(item => {
                    const icon = item.querySelector('i');
                    item.classList.remove('active');
                    icon.className = icon.className.replace('ph-fill', 'ph');
                });
                const activeNavItem = document.getElementById(`nav-${navId}`);
                if (activeNavItem) {
                    activeNavItem.classList.add('active');
                    const icon = activeNavItem.querySelector('i');
                    if (!icon.className.includes('ph-fill')) {
                        icon.className = icon.className.replace('ph', 'ph-fill');
                    }
                }
            }
            
            if (pageId === 'wallet-page') updateWalletUI();
            if (pageId === 'loyalty-page') updateLoyaltyUI();
            if (pageId === 'payment-page') updatePaymentPageUI();
        }


        // --- ONBOARDING LOGIC ---
        const onboardingSlides = [
            {
                icon: 'bus',
                title: 'AXORA-TACHYS',
                text: 'Reclaim Your Commute Dignity.'
            },
            {
                icon: 'check-square-offset',
                title: 'Book Your Seat in Seconds',
                text: 'Easily find routes, select your preferred seat, and book your trip instantly.'
            },
            {
                icon: 'wallet',
                title: 'Pay with Your Wallet',
                text: 'Top up your wallet for faster payments and exclusive loyalty rewards.'
            },
            {
                icon: 'coin',
                title: 'Earn & Redeem Coins',
                text: 'Earn coins with every trip and redeem 400 coins for a free ride worth KES 100.'
            }
        ];
        let currentSlide = 0;
        const onboardingContent = document.getElementById('onboarding-content');
        const onboardingDots = document.getElementById('onboarding-dots');
        const nextBtn = document.getElementById('onboarding-next-btn');
        const skipBtn = document.getElementById('onboarding-skip-btn');

        function showOnboardingSlide(index) {
            const slide = onboardingSlides[index];
            onboardingContent.innerHTML = `
                <div class="text-center space-y-4 mb-8">
                    <i class="ph-bold ph-${slide.icon}" style="font-size: 80px; color: var(--accent-color);"></i>
                    <h2 class="text-3xl font-bold text-gray-800 dark:text-gray-200">${slide.title}</h2>
                    <p class="text-gray-500 dark:text-gray-400 text-lg">${slide.text}</p>
                </div>
            `;
            
            onboardingDots.innerHTML = onboardingSlides.map((_, i) => 
                `<span class="w-2.5 h-2.5 rounded-full ${i === index ? 'bg-teal-500' : 'bg-gray-300 dark:bg-gray-600'}"></span>`
            ).join('');

            if (index === onboardingSlides.length - 1) {
                nextBtn.textContent = 'Get Started';
            } else {
                nextBtn.textContent = 'Next';
            }
        }

        nextBtn.addEventListener('click', () => {
            if (currentSlide < onboardingSlides.length - 1) {
                currentSlide++;
                showOnboardingSlide(currentSlide);
            } else {
                showPage('login-signup-page', null);
            }
        });

        skipBtn.addEventListener('click', () => {
            showPage('login-signup-page', null);
        });

        // --- LOGIN/SIGNUP TABS ---
        const loginTabBtn = document.getElementById('login-tab-btn');
        const signupTabBtn = document.getElementById('signup-tab-btn');
        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');

        loginTabBtn.addEventListener('click', () => {
            loginForm.classList.remove('hidden');
            signupForm.classList.add('hidden');
            loginTabBtn.classList.add('bg-white', 'shadow', 'dark:bg-gray-800');
            loginTabBtn.classList.remove('text-gray-600', 'dark:text-gray-400');
            signupTabBtn.classList.remove('bg-white', 'shadow', 'dark:bg-gray-800');
            signupTabBtn.classList.add('text-gray-600', 'dark:text-gray-400');
        });

        signupTabBtn.addEventListener('click', () => {
            signupForm.classList.remove('hidden');
            loginForm.classList.add('hidden');
            signupTabBtn.classList.add('bg-white', 'shadow', 'dark:bg-gray-800');
            signupTabBtn.classList.remove('text-gray-600', 'dark:text-gray-400');
            loginTabBtn.classList.remove('bg-white', 'shadow', 'dark:bg-gray-800');
            loginTabBtn.classList.add('text-gray-600', 'dark:text-gray-400');
        });

        // --- BOOKING PAGE: SEAT MAP ---
        const seatMap = document.getElementById('seat-map');
        const bookedSeats = ['2A', '2B', '4C', '5A', '5D', '8B', '8C'];
        let selectedSeat = null;

        for (let i = 1; i <= 10; i++) {
            ['A', 'B', '', 'C', 'D'].forEach(letter => {
                if (letter === '') {
                    seatMap.innerHTML += `<div></div>`;
                    return;
                }
                const seatId = `${i}${letter}`;
                const isBooked = bookedSeats.includes(seatId);
                const seatDiv = document.createElement('div');
                seatDiv.className = `w-10 h-10 flex items-center justify-center text-xs font-bold rounded cursor-pointer transition`;
                seatDiv.textContent = seatId;
                
                if (isBooked) {
                    seatDiv.classList.add('bg-red-500', 'text-white', 'cursor-not-allowed');
                } else {
                    seatDiv.classList.add('bg-gray-200', 'text-gray-600', 'hover:bg-gray-300');
                    seatDiv.classList.add('dark:bg-gray-600', 'dark:text-gray-300', 'dark:hover:bg-gray-500');
                    seatDiv.addEventListener('click', () => {
                        if (selectedSeat) {
                            selectedSeat.classList.remove('!bg-teal-600', '!text-white');
                            selectedSeat.classList.add('bg-gray-200', 'text-gray-600');
                            selectedSeat.classList.add('dark:bg-gray-600', 'dark:text-gray-300');
                        }
                        seatDiv.classList.remove('bg-gray-200', 'text-gray-600', 'dark:bg-gray-600', 'dark:text-gray-300');
                        seatDiv.classList.add('!bg-teal-600', '!text-white');
                        selectedSeat = seatDiv;
                    });
                }
                seatMap.appendChild(seatDiv);
            });
        }
        
        // --- LOYALTY & WALLET LOGIC ---
        function updateWalletUI() {
            document.getElementById('wallet-balance-display').textContent = `KES ${appState.walletBalance.toFixed(2)}`;
            const transactionsContainer = document.getElementById('wallet-transactions');
            transactionsContainer.innerHTML = appState.walletTransactions.map(tx => {
                const isTopUp = tx.amount > 0;
                return `
                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center space-x-3">
                        <div class="p-2 rounded-full ${isTopUp ? 'bg-green-100 dark:bg-green-900' : 'bg-red-100 dark:bg-red-900'}">
                            <i class="ph-bold ${isTopUp ? 'ph-arrow-down-left text-green-600' : 'ph-arrow-up-right text-red-600'}"></i>
                        </div>
                        <div>
                            <p class="font-medium text-gray-800 dark:text-gray-200">${tx.type === 'Top-up' ? `Top-up via ${tx.method}` : tx.description}</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">${tx.date}</p>
                        </div>
                    </div>
                    <p class="font-bold ${isTopUp ? 'text-green-600' : 'text-red-600'}">${isTopUp ? '+' : ''}${tx.amount.toFixed(2)}</p>
                </div>
                `;
            }).join('');
        }

        function updateLoyaltyUI() {
            const coinValue = appState.loyaltyCoins * 0.25;
            document.getElementById('loyalty-coin-balance').textContent = appState.loyaltyCoins;
            document.getElementById('loyalty-coin-value').textContent = `Equal to KES ${coinValue.toFixed(2)}`;
            const historyContainer = document.getElementById('loyalty-history');
            historyContainer.innerHTML = appState.coinHistory.map(tx => {
                const isEarned = tx.amount > 0;
                return `
                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 flex justify-between items-center">
                    <div>
                        <p class="font-medium text-gray-800 dark:text-gray-200">${tx.description}</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400">${tx.date}</p>
                    </div>
                    <p class="font-bold flex items-center space-x-1 ${isEarned ? 'text-green-600' : 'text-red-600'}">
                        <span>${isEarned ? '+' : ''}${tx.amount}</span>
                        <i class="ph-fill ph-coin text-yellow-500"></i>
                    </p>
                </div>
                `;
            }).join('');
        }
        
        function updatePaymentPageUI() {
            const coinValue = appState.loyaltyCoins * 0.25;
            document.getElementById('payment-wallet-balance').textContent = `Balance: KES ${appState.walletBalance.toFixed(2)}`;
            document.getElementById('payment-coin-balance').textContent = appState.loyaltyCoins;
            document.getElementById('payment-coin-value').textContent = coinValue.toFixed(2);
        }

        // --- QUICK PAY LOGIC ---
        const busCodeInput = document.getElementById('bus-code-input');
        const findBusBtn = document.getElementById('find-bus-btn');
        const busInfo = document.getElementById('bus-info');
        const errorMessage = document.getElementById('error-message');
        const payBtn = document.getElementById('pay-btn');

        findBusBtn.addEventListener('click', () => {
            const code = busCodeInput.value.trim();
            if (/^\d{3}$/.test(code)) {
                busInfo.classList.remove('hidden');
                errorMessage.classList.add('hidden');
            } else {
                busInfo.classList.add('hidden');
                errorMessage.classList.remove('hidden');
            }
        });

        // --- DARK MODE TOGGLE ---
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        darkModeToggle.addEventListener('change', () => {
            if (darkModeToggle.checked) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
        
        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            document.documentElement.classList.remove('dark');
            showOnboardingSlide(0);
            showPage('onboarding-page');
            applyMobileScaling();
            
            // Re-apply scaling on window resize
            window.addEventListener('resize', applyMobileScaling);
        });
    </script>
</body>
</html>




